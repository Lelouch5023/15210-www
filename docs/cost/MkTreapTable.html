<!--#set var="name" value="MkTreapTable"-->
<!--#set var="type" value="functor"-->
<!--#include virtual="../../includes/cost-header.html"-->
  <h2>Overview</h2>
  <code>functor MkTreapTable(structure HashKey :
    <!--<a href="../sig/HASHKEY.html">-->HASHKEY<!--</a>-->) : TABLE</code>
  <p>Implements <a href="../sig/SET.html"><code>SET</code></a> and
    <a href="../sig/TABLE.html"><code>TABLE</code></a> simultaneously
    with a <!--<a href="MkTreap.sml">--><code>Treap</code><!--</a>-->
    <!--<a href="../sig/BST.html">--><code>BST</code><!--</a>-->, where
    <blockquote><code>type 'a table = 'a bst<br />
      type set = unit bst
    </code></blockquote>
    The <a href="../sig/TABLE.html#spec-Seq"><code>Seq</code></a>
    substructure is defined to be
    <a href="ArraySequence.html"><code>ArraySequence</code></a>.
  </p>

  <h2><code>SET</code> and <code>TABLE</code> Cost Specifications</h2>
  <p>The following costs assume that the work and span of the application
    of <code>Key.compare</code> is constant. For
    <a href="#spec-insert">insert</a> and <a href="#spec-merge">merge</a>,
    the given costs assume that the work and span of the application
    of $f$ is constant.</p>
  <table class="cost">
    <thead>
      <tr>
        <td></td>
        <td>Work</td>
        <td>Span</td>
      </tr>
    </thead>
    <tr>
      <td><code>size</code> $T$</td>
      <td>\[O(1)\]</td>
      <td>\[O(1)\]</td>
    </tr>
    <tr>
      <td><code>toSeq</code> $T$<br />
        <code>domain</code> $T$<br />
        <code>range</code> $T$</td>
      <td>\[O(|T|)\]</td>
      <td>\[O(\log|T|)\]</td>
    </tr>
    <tr>
      <td><code>fromSeq</code> $S$</td>
      <td>\[O(|S|\log|S|)\]</td>
      <td>\[O(\log^2|S|)\]</td>
    </tr>
    <tr>
      <td><code>find</code> $T\:k$<br />
        <code>insert</code> $f\:(k,v)\:T$<br />
        <code>delete</code> $k\:T$</td>
      <td>\[O(\log|T|)\]</td>
      <td>\[O(\log|T|)\]</td>
    </tr>
    <tr>
      <td><code>tabulate</code> $f\:S$<br />
      <td>\[\sum_{k\in S} W(f(k))\]</td>
      <td>\[\max_{k\in S} S(f(k))\]</td>
    </tr>
    <tr>
      <td><code>collect</code> $S$<br />
        <code>fromSeq</code> $S$</td>
      <td>\[O(|S|\log|S|)\]</td>
      <td>\[O(\log^2|S|)\]</td>
    </tr>
    <tr>
      <td><code>map</code> $f\:T$</td>
      <td>\[\sum_{(k,v)\in T} W(f(v))\]</td>
      <td>\[\max_{(k,v)\in T} S(f(v))\]</td>
    </tr>
    <tr>
      <td><code>mapk</code> $f\:T$</td>
      <td>\[\sum_{(k,v)\in T} W(f(k,v))\]</td>
      <td>\[\max_{(k,v)\in T} S(f(k,v))\]</td>
    </tr>
    <tr>
      <td><code>filter</code> $p\:T$</td>
      <td>\[\sum_{(k,v)\in T} W(p(k,v))\]</td>
      <td>\[O(\log|T|) + \max_{(k,v)\in T} S(p(k,v))\]</td>
    </tr>
  </table>

  <p>For <a href="#spec-iter">iter</a> and <a href="#spec-iterh">iterh</a>,
    $i$ is the index in the implementation-defined
    order of the key-value pairs.
    For <a href="#spec-reduce">reduce</a>, $\mathcal{O}_r(f,b,S)$
    represents the set of applications of $f$ as defined in the
    <a href="../sig/SEQUENCE.html"><code>SEQUENCE</code></a>
    specification.
  </p>
  <table class="cost">
    <thead>
      <tr>
        <td></td>
        <td>Work</td>
        <td>Span</td>
      </tr>
    </thead>
    <tr>
      <td><code>iter</code> $f\:b_0\:T$<br />
        <code>iterh</code> $f\:b_0\:T$</td>
      <td>\[\sum_{i=0}^{|T|-1} W(f(b_i,(k_i,v_i)))\]</td>
      <td>\[\sum_{i=0}^{|T|-1} S(f(b_i,(k_i,v_i)))\]</td>
    </tr>
    <tr>
      <td><code>reduce</code> $f\:b\:T$</td>
      <td>\[O(|S|)+\sum_{f(x,y)\in\mathcal{O}_r(f,b,S)} W(f(x,y))\]</td>
      <td>\[O\left(\log|S|\max_{f(x,y)\in\mathcal{O}_r(f,b,S)}
        S(f(x,y))\right)\]</td>
    </tr>
  </table>

  <p>For the following functions, assume that $n=\mathsf{max}(|S|,|T|)$
    and $m=\mathsf{min}(|S|,|T|)$.</p>
  <table class="cost">
    <thead>
      <tr>
        <td></td>
        <td>Work</td>
        <td>Span</td>
      </tr>
    </thead>
    <tr>
      <td><code>union</code> $(S,T)$<br />
        <code>inter</code> $(S,T)$<br />
        <code>diff</code> $(S,T)$</td>
      <td>\[O\left(m\log\left(\frac{n+m}{m}\right)\right)\]</td>
      <td>\[O(\log(n+m))\]</td>
    </tr>
    <tr>
      <td><code>merge</code> $f\:(S,T)$<br />
        <code>extract</code> $(S,T)$<br />
        <code>erase</code> $(S,T)$</td>
      <td>\[O\left(m\log\left(\frac{n+m}{m}\right)\right)\]</td>
      <td>\[O(\log(n+m))\]</td>
    </tr>
  </table>
  <!--#include virtual="../../includes/page-footer.html"-->
</body>
</html>
